\documentclass[class=article, crop=false]{standalone}
%\usepackage[subpreambles=true]{standalone}
\usepackage{import}
%\input{../packages}
\begin{document}
\pgfplotsset{width=14cm,compat=1.9}
\section{Alpha tuning}\label{sec:alphatune}

Since our system is two dimensional and the x and y state depends highly not just on the $\alpha$, but the $\beta$ parameter in our input coupling matrix $\boldsymbol{\Gamma}_k$ and process noise input coupling matrix $\textbf{G}_k$, we set the input $u_k^\eta$ and $y_k^\chi$ zero. This way we make the x and y state independant of $\beta$ and can fine tune $\alpha$ without it effecting our results. This corresponds to driving the robot in a straight line.

\subsection{Reference}

In our first experiment we set different $\alpha$ values and examine its influence on the x and v state. We do this with a set ratio $\varrho^{\vartheta\zeta} = 0.005$, which we picked because it is a middle ground between correcting too much and too little of $u_k^{\vartheta}$ with $y_k^{\zeta}$.

Since the input and output is not the same dimension, the correction can be done only to a certain degree, after which further $\varrho^{\vartheta\zeta}$ increase doesn't change the state.

\vspace{0.5cm}

\begin{figure}[H]
\begin{flushleft}
  \begin{tikzpicture}
    \begin{axis}[
      yticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=5
      },
      xmin=0,
      xmax=22,
      width=12cm,
      height=5cm,
      xtick distance=2,
      ytick distance=0.1,
      xlabel={Time $[s]$},
      ylabel={$ u^\vartheta_k$ $[m/s]$},
      grid=both,
      grid style={
        line width=.1pt,
        draw=gray!10},
        major grid style={
          line width=.2pt,
          draw=gray!50
        },
      ]
      \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_0_u0.csv};
    \end{axis}
  \end{tikzpicture}
\end{flushleft}
\begin{flushleft}
  \begin{tikzpicture}
    \begin{axis}[
      yticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=5
      },
      width=12cm,
      height=5cm,
      xmin=0,
      xmax=22,
      xtick distance=2,
      ytick distance=4,
      xlabel={Time $[s]$},
      ylabel={$ y^\zeta_k$ $[m/s^2] $},
      grid=both,
      grid style={
        line width=.1pt,
        draw=gray!10},
        major grid style={
          line width=.2pt,
          draw=gray!50
        },
      ]
      \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_0_y0.csv};
    \end{axis}
  \end{tikzpicture}
\end{flushleft}
\caption{$ \textbf{u}_k $ and $ \textbf{y}_k $ of the alpha tuning reference experiment}\label{fig:alphas_io}
\end{figure}

\vspace{0.5cm}

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-4,
     xmax=22,
     xtick distance=2,
     ytick distance=1,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=teal, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_4_x0.csv};
    \addlegendentry{2.4}
    \addplot+[color=violet, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_3_x0.csv};
    \addlegendentry{2.2}
    \addplot+[color=black, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_2_x0.csv};
    \addlegendentry{2.0}
    \addplot+[color=red, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_1_x0.csv};
    \addlegendentry{1.8}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_0_x0.csv};
    \addlegendentry{1.6}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-4,
     xmax=22,
     xtick distance=2,
     ytick distance=0.2,
     xlabel={Time $[s]$},
     ylabel={v state [m/s]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
    ]
    \addplot+[color=teal, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_4_x2.csv};
    \addlegendentry{2.4}
    \addplot+[color=violet, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_3_x2.csv};
    \addlegendentry{2.2}
    \addplot+[color=black, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_2_x2.csv};
    \addlegendentry{2.0}
    \addplot+[color=red, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_1_x2.csv};
    \addlegendentry{1.8}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alphas_0_x2.csv};
    \addlegendentry{1.6}
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Different $\alpha$-s influence on the x and v state in the alpha tuning reference experiment}\label{fig:alphas}
\end{figure}

\vspace{0.5cm}

We can see in Figure \ref{fig:alphas_io} that the system output $ y^\zeta_k$ measured by our IMU's accelerometer is very noisy during movement. This is due to our motor's vibrations which are still significant even though we tried several methods to reduce it.

The robot's real world distance was 5 meters, which we marked with a dashed gray line in Figure \ref{fig:alphas}. We set $\alpha$ to closest plot, which is the red one with $\alpha = 1.8$.

\subsection{Testing}\label{subsec:alphatesting}

Since we stop multiple times in our reference experiment, we will examine how our system holds up when we go the same distance with less stops. This might show us if the stops bear an impact on our x state estimate due to more frequent acceleration and deceleration.

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=1,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red, dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_0_x0.csv};
    \addlegendentry{reference}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_single_0_x0.csv};
    \addlegendentry{few stops}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Reference experiment compared with driving 5m distance with less stops using a Kalman Filter}\label{fig:alphasingle}
\end{figure}

\vspace{0.5cm}

We see in Figure \ref{fig:alphasingle} that the amount of stops barely changes the travelled distance.

Now let's see a different experiment, where we travel twice the distance from the reference and see if our system can estimate it to around 10 meters.

\vspace{0.5cm}

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=2,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red, dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_0_x0.csv};
    \addlegendentry{reference}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_multi_0_x0.csv};
    \addlegendentry{10 meters}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {10.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Reference compared to driving 10m distance using a Kalman Filter}\label{fig:alphamulti}
\end{figure}

\vspace{0.5cm}

The 10 meter run in Figure \ref{fig:alphamulti} shows that it overshoots the estimation about 1 meter. This may be due to non-linearity in our real motor speed and $u_k^\vartheta$ at higher speeds. We can't correct this adequately with our IMU due to motor induced measurement noise.

Now let's run the same experiments with the adaptive Kalman Filter to see if the added inital IMU measurements impact our estimations.

The adaptive Kalman Filter's window length was set to 10, which means we estimate the acceleration phase to last about 0.2 seconds, and set $M_1 = 100$.

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=1,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red, dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_0_x0.csv};
    \addlegendentry{reference}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_adapt_0_x0.csv};
    \addlegendentry{adaptive}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{5m reference experiment using the adaptive Kalman Filter}\label{fig:adaptalpha}
\end{figure}

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=1,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red,dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_single_0_x0.csv};
    \addlegendentry{reference}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_single_adapt_0_x0.csv};
    \addlegendentry{adaptive}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{5m with less stops using the adaptive Kalman Filter}\label{fig:adaptalphasingle}
\end{figure}

\vspace{0.5cm}

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=2,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red, dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_multi_0_x0.csv};
    \addlegendentry{reference}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_multi_adapt_0_x0.csv};
    \addlegendentry{adaptive}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {10.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Driving 10m using the adaptive Kalman Filter}\label{fig:adaptalphamulti}
\end{figure}

The repeated experiments seen in Figures \ref{fig:adaptalpha}, \ref{fig:adaptalphasingle} and \ref{fig:adaptalphamulti} show that the additional IMU corrections during the acceleration phase barely impact our state estimations.

Next, we repeat the experiments similarly with the Extended Kalman Filter, but we use $u_k^\eta$ and $y_k^\chi$ and the $\beta$ set from the next section for a more practical comparison.

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=1,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red, dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_adapt_0_x0.csv};
    \addlegendentry{adaptive}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_ekf_0_x0.csv};
    \addlegendentry{EKF}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Reference experiment using the Extended Kalman Filter}\label{fig:ekfalpha}
\end{figure}

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=1,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red,dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_single_adapt_0_x0.csv};
    \addlegendentry{adaptive}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_single_ekf_0_x0.csv};
    \addlegendentry{EKF}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Driving 5m distance with less stops experiment using the Extended Kalman Filter}\label{fig:ekfalphasingle}
\end{figure}

\vspace{0.5cm}

\begin{figure}[H]
 \begin{flushleft}
  \begin{tikzpicture}
   \begin{axis}[
     yticklabel style={
       /pgf/number format/fixed,
       /pgf/number format/precision=5
      },
     width=12cm,
     height=5cm,
     xmin=-1,
     xmax=22,
     xtick distance=2,
     ytick distance=2,
     xlabel={Time $[s]$},
     ylabel={x state [m]},
     legend pos=north west,
     grid=both,
     grid style={
       line width=.1pt,
       draw=gray!10},
     major grid style={
       line width=.2pt,
       draw=gray!50
      },
      domain=0:22,
    ]
    \addplot+[color=red, dashed, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_multi_adapt_0_x0.csv};
    \addlegendentry{adaptive}
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt] table {plots/alpha_multi_ekf_0_x0.csv};
    \addlegendentry{EKF}
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {5.0};
    \addplot+[color=gray, mark=none,line width=1pt,mark size=1pt, samples=2, dashed] {10.0};
   \end{axis}
  \end{tikzpicture}
 \end{flushleft}
 \caption{Driving 10m distance using the Extended Kalman Filter}\label{fig:ekfalphamulti}
\end{figure}

Though there are some slight differences in the state estimations, but they are largely the same, which means that without additional sensor refinement and covariance adjustment there is little to be gained by further parameter tweaking.

\end{document}
