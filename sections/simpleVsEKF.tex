\documentclass[class=article, crop=false]{standalone}
%\usepackage[subpreambles=true]{standalone}
\usepackage{import}
\input{../packages}
\begin{document}
\pgfplotsset{width=14cm,compat=1.9}
\section{Simple Kalman Filter comparison}\label{sec:expcomp}

In this experiment we compare our Simple Kalman Filter(SKF) to the robot\_localization packgage's Extended Kalman Filter(EKF).

As the system input we use the same parameters as in Section \ref{sec:expcovar}.

The robot was moved in a straight line and the messages from the Gamepad and IMU were recorded with rosbag. Launching the filter nodes was done offline with the rosbag recording for proper direct comparison of the estimated states. In this case the adaptive ability of the Simple Kalman Filter was disabled. We used a ratio of $ \textbf{r}_{k} = \frac{1}{3} $.

\vspace{0.5cm}

\begin{figure}
\begin{flushleft}
\begin{tikzpicture}
  \begin{axis}[
    yticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=5
    },
    width=12cm,
    height=5cm,
    xtick distance=0.5,
    ytick distance=0.05,
    xlabel={Time $[s]$},
    ylabel={$\textbf{x}_k$ state $[m]$},
    legend pos=north west,
    grid=both,
    grid style={
      line width=.1pt,
      draw=gray!10},
      major grid style={
        line width=.2pt,
        draw=gray!50
      },
    ]
    \addplot+[smooth,color=blue, mark=none,line width=1pt,mark size=1pt, dashed] table {../plots/ekf_pos.csv};
    \addlegendentry{EKF}
    \addplot+[smooth,color=red, mark=none,line width=1pt,mark size=1pt] table {../plots/real_robot_dist_None.csv};
    \addlegendentry{SKF}
  \end{axis}
\end{tikzpicture}
\end{flushleft}

\begin{flushleft}
\begin{tikzpicture}
  \begin{axis}[
    yticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=5
    },
    width=12cm,
    height=5cm,
    xtick distance=0.5,
    ytick distance=0.05,
    xlabel={Time $[s]$},
    ylabel={$\dot{\textbf{x}}_k$ state $[m/s]$},
    legend pos=north west,
    grid=both,
    grid style={
      line width=.1pt,
      draw=gray!10},
      major grid style={
        line width=.2pt,
        draw=gray!50
      },
    ]
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt, dashed] table {../plots/ekf_vel.csv};
    \addlegendentry{EKF}
    \addplot+[color=red, mark=none,line width=1pt,mark size=1pt] table {../plots/real_robot_vel_None.csv};
    \addlegendentry{SKF}
  \end{axis}
\end{tikzpicture}\label{fig:xdotcompare}
\end{flushleft}
\caption{$ \textbf{x}_k $ and $\dot{\textbf{x}}_k $ state estimate comparison}\label{fig:statescompare}
\end{figure}

We can observe the difference in Figure \ref{fig:statescompare} in how the acceleration during movement is seen in the $\dot{\textbf{x}}_k $ state estimation. SFK deals better with such erratic changes in $ \textbf{u}^1_k $ and smooths them out. The jump in velocity 

\vspace{0.5cm}

\begin{figure}
\begin{flushleft}
\begin{tikzpicture}
  \begin{axis}[
    yticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=5
    },
    width=12cm,
    height=5cm,
    xtick distance=0.5,
    ytick distance=0.05,
    xlabel={Time $[s]$},
    ylabel={$\textbf{x}_k$ state $[m]$},
    legend pos=north west,
    grid=both,
    grid style={
      line width=.1pt,
      draw=gray!10},
      major grid style={
        line width=.2pt,
        draw=gray!50
      },
    ]
    \addplot+[smooth,color=blue, mark=none,line width=1pt,mark size=1pt, dashed] table {../plots/ekf_pos.csv};
    \addlegendentry{EKF}
    \addplot+[smooth,color=red, mark=none,line width=1pt,mark size=1pt] table {../plots/real_robot_dist_sig.csv};
    \addlegendentry{SKF(sig)}
  \end{axis}
\end{tikzpicture}
\end{flushleft}

\begin{flushleft}
\begin{tikzpicture}
  \begin{axis}[
    yticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=5
    },
    width=12cm,
    height=5cm,
    xtick distance=0.5,
    ytick distance=0.05,
    xlabel={Time $[s]$},
    ylabel={$\dot{\textbf{x}}_k$ state $[m/s]$},
    legend pos=north west,
    grid=both,
    grid style={
      line width=.1pt,
      draw=gray!10},
      major grid style={
        line width=.2pt,
        draw=gray!50
      },
    ]
    \addplot+[color=blue, mark=none,line width=1pt,mark size=1pt, dashed] table {../plots/ekf_vel.csv};
    \addlegendentry{EKF}
    \addplot+[color=red, mark=none,line width=1pt,mark size=1pt] table {../plots/real_robot_vel_sig.csv};
    \addlegendentry{SKF(sig)}
  \end{axis}
\end{tikzpicture}\label{fig:xdotcompare}
\end{flushleft}
\caption{$ \textbf{x}_k $ and $\dot{\textbf{x}}_k $ state estimate comparison}\label{fig:statescompare}
\end{figure}

\end{document}
